.#+TITLE: My Sway Config
#+AUTHOR: Arya K
#+PROPERTY: header-args :tangle config
#+auto_tangle: t
* Initialization
This section has some basic stuff I need in my config

First we need to warn people (Mostly myself lol) to not edit the config by hand and to use the literate one
#+begin_src conf-space
# This file is generated by config.org.
# DO NOT EDIT THIS FILE
#+end_src
** Screensharing
Screensharing is pretty important to me.

Even though i miss being able to share specific windows, it works pretty nicely most of the time.

You need to install pipewire xdg-desktop-portal{,-gtk,-wlr}.
If you use systemd (IKR who uses systemd), everything should work out of the box
#+BEGIN_SRC conf-space
exec systemctl --user import-environment WAYLAND_DISPLAY XDG_CURRENT_DESKTOP
# GTK3 applications take a long time to start
# exec systemctl --user import-environment DISPLAY WAYLAND_DISPLAY SWAYSOCK
exec hash dbus-update-activation-environment 2>/dev/null && \
dbus-update-activation-environment --systemd DISPLAY WAYLAND_DISPLAY SWAYSOCK

#+END_SRC
** Keyboard and touchpad configuration
TBH xorg.conf.d files kinda suck
#+begin_src conf-space
input type:touchpad {
      dwt enabled
      tap enabled
      natural_scroll enabled
}
input type:keyboard {
      xkb_layout "us"
      xkb_options caps:backspace
}
focus_follows_mouse yes
#+end_src
** Apply GTK theming by default
Self explanatory, isnt it?
#+begin_src conf-space
exec_always ~/.config/sway/scripts/import-gsettings
#+end_src
** Use Fira Code as my font
#+begin_src conf-space
font pango:Noto Sans 10
#+end_src
** Set Wallpaper
I use a script to change my wallpaper randomly every 10 seconds

Kill any running instance of the script and then run it again
(best way i have found to not have wallpapers changing every second when i restart sway a couple times)
#+begin_src conf-space
exec "killall wallpaper.sh"
exec "~/.config/sway/scripts/wallpaper.sh"
#+end_src
** Start waybar
Waybar is the best bar i have found for sway (I mean basically for all WMs)

It uses CSS which makes it really easy to customize the look and feel of it.

#+begin_src conf-space
bar {
   swaybar_command waybar
}
#+end_src
** Xwayland
Xwayland is basically needed if you are using wayland.

A large amount of apps i use on a daily basis dont work natively on wayland

#+begin_src conf-space
xwayland enable
# Title format for windows
for_window [shell="xdg_shell"] title_format "%title (%app_id)"
for_window [shell="x_wayland"] title_format "%class - %title"
#+end_src

** No title bar
Do you think I am a child?
#+begin_src conf-space
# Hide titlebar on windows:
default_border pixel 1
#+end_src
** IDLE
#+begin_src conf-space
### Idle configuration
exec swayidle -w\
    timeout 1070 'swaylock -f -C ~/.config/swaylock/config'\
    timeout 770 'swaymsg "output * dpms off"' \
    resume 'swaymsg "output * dpms on"' \
    before-sleep 'swaylock -C ~/.config/swaylock/config'
#+end_src
* Theming
My config is mostly centred around arc dark but I am trying to change that (slowly)
** Borders and gaps
I use sway-borders fork for rounded corners (Yes its not really rounded but just a border that is rounded but still)
#+begin_src conf-space
# Thin borders:
smart_borders on
gaps inner 28
gaps outer -8
#+end_src
*** Rounded Corners
#+begin_src conf-space
border_images.focused ~/.config/sway/images/focused.png
border_images.focused_inactive ~/.config/sway/images/focused_inactive.png
border_images.unfocused ~/.config/sway/images/unfocused.png
border_images.urgent ~/.config/sway/images/urgent.png
#+end_src
** Colours
This actually doesnt matter but i like to have it set anyways lol

#+begin_src conf-space
# class                 border  bground text    indicator child_border
client.focused          #6272A4 #6272A4 #F8F8F2 #6272A4   #6272A4
client.focused_inactive #44475A #44475A #F8F8F2 #44475A   #44475A
client.unfocused        #282A36 #282A36 #BFBFBF #282A36   #282A36
client.urgent           #44475A #FF5555 #F8F8F2 #FF5555   #FF5555
client.placeholder      #282A36 #282A36 #F8F8F2 #282A36   #282A36
client.background       #F8F8F2
#+end_src
* Keybindings
I have a lot lol

Firstly I have to set the nav keys (arrow + ijkl) and super keys
#+begin_src conf-space
# Logo key. Use Mod1 for Alt.
set $mod Mod4
set $alt Mod1
# Home row direction keys, like vim
set $left j
set $down k
set $up i
set $right l

#+end_src

** Variables
These are preference variables
#+begin_src conf-space
set $term alacritty
set $runmenu exec $term --class=launcher -e sway-launcher-desktop
set $powermenu ~/.config/waybar/scripts/power-menu.sh
set $menu wofi -c ~/.config/wofi/config -I
#+end_src
** Basic Keybindings
#+begin_src conf-space
for_window [app_id="^launcher$"] floating enable, sticky enable, resize set 30 ppt 60 ppt, border pixel 10
# Start a floating terminal
bindsym $mod+Return exec $term
bindsym $mod+d exec $runmenu

# Open the power menu
bindsym $mod+Shift+q exec $powermenu
bindsym $mod+f1 exec ~/.config/sway/scripts/lockman.sh

# Kill focused window
# bindsym $mod+q [con_id="__focused__" instance="^(?!scratchpad).*$"] kill
# bindsym $mod+q [con_id="__focused__" instance="^(?!scratchpad-name).*$"] kill
bindsym $mod+q kill
bindsym $mod+Shift+c kill
bindsym $mod+z gaps inner all plus 10
bindsym $mod+x gaps inner all minus 10
bindsym $mod+a resize shrink width 10px
bindsym $mod+s resize grow width 10px
bindsym $mod+e resize shrink height 10px
bindsym $mod+r resize grow height 10px
# Reload the configuration file
bindsym $mod+Shift+r reload
#+end_src
** Navigation
#+begin_src conf-space
# Move your focus around
bindsym $mod+$left focus left
bindsym $mod+$down focus down
bindsym $mod+$up focus up
bindsym $mod+$right focus right
# Or use $mod+[up|down|left|right]
bindsym $mod+Left focus left
bindsym $mod+Down focus down
bindsym $mod+Up focus up
bindsym $mod+Right focus right
# Move the focused window with the same, but add Shift
bindsym $mod+Shift+$left move left
bindsym $mod+Shift+$down move down
bindsym $mod+Shift+$up move up
bindsym $mod+Shift+$right move right
# Ditto, with arrow keys
bindsym $mod+Shift+Left move left
bindsym $mod+Shift+Down move down
bindsym $mod+Shift+Up move up
bindsym $mod+Shift+Right move right
#+end_src
** Workspaces
#+begin_src conf-space
# Switch to workspace
bindsym $mod+1 workspace number 1
bindsym $mod+2 workspace number 2
bindsym $mod+3 workspace number 3
bindsym $mod+4 workspace number 4
bindsym $mod+5 workspace number 5
bindsym $mod+6 workspace number 6
bindsym $mod+7 workspace number 7
bindsym $mod+8 workspace number 8
bindsym $mod+9 workspace number 9
# Move focused container to workspace
bindsym $mod+Shift+1 move container to workspace number 1
bindsym $mod+Shift+2 move container to workspace number 2
bindsym $mod+Shift+3 move container to workspace number 3
bindsym $mod+Shift+4 move container to workspace number 4
bindsym $mod+Shift+5 move container to workspace number 5
bindsym $mod+Shift+6 move container to workspace number 6
bindsym $mod+Shift+7 move container to workspace number 7
bindsym $mod+Shift+8 move container to workspace number 8
bindsym $mod+Shift+9 move container to workspace number 9
bindsym $mod+f fullscreen
#+end_src
** XF86
Useful when I use my laptop keyboard?
#+begin_src conf-space
bindsym --locked XF86AudioRaiseVolume exec pamixer -ui 2
bindsym --locked XF86AudioLowerVolume exec pamixer -ud 2
bindsym --locked XF86AudioMute exec pamixer -t
#
# Player
#
bindsym XF86AudioPlay exec playerctl play
bindsym XF86AudioPause exec playerctl pause
bindsym XF86AudioNext exec playerctl next
bindsym XF86AudioPrev exec playerctl previous
#
# Backlight
#
bindsym XF86MonBrightnessUp exec brightnessctl -c backlight set +5%
bindsym XF86MonBrightnessDown exec brightnessctl -c backlight set 5%-
#
# Screenshots
#
bindsym print exec grimshot --notify save output
bindsym Shift+print exec ~/.config/sway/scripts/screenshot.sh

#+end_src
** Misc.
#+begin_src conf-space
for_window [app_id="dmenu"] floating enable, sticky enable, resize set 30 ppt 60 ppt, border pixel 10
bindsym $mod+c exec wl-clipboard-manager dmenu
bindsym $mod+p exec ~/.config/wofi/windows.py
bindsym Ctrl+Q exec ""
#+end_src
* Floating windows
There are still things that are better floating :(
#+begin_src conf-space
bindsym $mod+Shift+f floating toggle
floating_modifier $mod normal
# Resize floating windows with mouse scroll:
bindsym --whole-window --border $mod+button4 resize shrink height 5 px or 5 ppt
bindsym --whole-window --border $mod+button5 resize grow height 5 px or 5 ppt
bindsym --whole-window --border $mod+shift+button4 resize shrink width 5 px or 5 ppt
bindsym --whole-window --border $mod+shift+button5 resize grow width 5 px or 5 ppt
#+end_src
* Scratchpads
#+begin_src conf-space
# exec --no-startup-id $term --class "scratchpad-name"
# for_window [class="scratchpad-name"] floating enable;
# for_window [class="scratchpad-name"] move scratchpad; [class="scratchpad-name"] scratchpad show; move position 80px 50px; move scratchpad
# bindsym $mod+Shift+Return [class="scratchpad-name"] scratchpad show, resize set 2800 1400

exec alacritty --class=terminal_scratchpad

for_window [app_id="terminal_scratchpad"] move scratchpad, resize set 1440 810
for_window [app_id="r_scratchpad"] move scratchpad, resize set 1440 810

bindsym $mod+Shift+Return [app_id="terminal_scratchpad"] scratchpad show
#+end_src
* Laptop lid close
#+begin_src conf-space
# Clamshell Mode
set $laptop <eDP-1>
bindswitch --reload --locked lid:on output $laptop disable
bindswitch --reload --locked lid:off output $laptop enable

exec_always ~/.config/sway/scripts/clamshell.sh
#+end_src
* App windowing defaults
#+begin_src conf-space
# set floating (nontiling)for apps needing it:
for_window [class="Yad" instance="yad"] floating enable
for_window [app_id="yad"] floating enable
for_window [app_id="blueman-manager"] floating enable,  resize set width 40 ppt height 30 ppt

# set floating (nontiling) for special apps:
for_window [class="Xsane" instance="xsane"] floating enable
for_window [app_id="pavucontrol" ] floating enable, resize set width 40 ppt height 30 ppt
for_window [class="qt5ct" instance="qt5ct"] floating enable, resize set width 60 ppt height 50 ppt
for_window [class="Bluetooth-sendto" instance="bluetooth-sendto"] floating enable
for_window [app_id="pamac-manager"] floating enable, resize set width 80 ppt height 70 ppt
for_window [class="Lxappearance"] floating enable, resize set width 60 ppt height 50 ppt

# set floating for window roles
for_window [window_role="pop-up"] floating enable
for_window [window_role="bubble"] floating enable
for_window [window_role="task_dialog"] floating enable
for_window [window_role="Preferences"] floating enable
for_window [window_type="dialog"] floating enable
for_window [window_type="menu"] floating enable
for_window [window_role="About"] floating enable
for_window [title="File Operation Progress"] floating enable, border pixel 1, sticky enable, resize set width 40 ppt height 30 ppt
for_window [app_id="firefox" title="Library"] floating enable, border pixel 1, sticky enable, resize set width 40 ppt height 30 ppt
for_window [app_id="floating_shell_portrait"] floating enable, border pixel 1, sticky enable, resize set width 30 ppt height 40 ppt
for_window [title="Picture in picture"] floating enable, sticky enable
for_window [title="nmtui"] floating enable,  resize set width 50 ppt height 70 ppt
for_window [title="htop"] floating enable, resize set width 50 ppt height 70 ppt
for_window [app_id="xsensors"] floating enable
for_window [title="Save File"] floating enable
for_window [app_id="firefox" title="Firefox — Sharing Indicator"] kill

# Inhibit idle
for_window [app_id="firefox"] inhibit_idle fullscreen
for_window [app_id="Chromium"] inhibit_idle fullscreen
#+end_src
* Autostart
#+begin_src conf-space
# Auth with polkit-gnome:
exec /usr/lib/polkit-gnome/*-authentication-agent-1

# Desktop notifications
exec mako
# Start up a GPG agent
exec eval $(gpg-agent --daemon) &
exec wl-clipboard-manager daemon
exec /usr/local/libexec/deja-dup/deja-dup-monitor # backup
exec kanshi # autorandr
exec redshift-gtk  -l 13.08784:80.27847 # Surprise! Redshift works on wayland (atleast with the fork). And no those are just the coordinates of a random place in my city
#+end_src
* Dynamic Tiling
Coming from DWM/Xmonad family its hard to live without this
#+begin_src conf-space
# start the dynamic tiling.
exec_always $HOME/.config/sway/scripts/i3ipc-dynamic-tiling --tabbed-hide-polybar true

# Disable the window title bar.
default_border pixel 2

hide_edge_borders smart
workspace_auto_back_and_forth yes
show_marks yes

# Toggle tabbed mode.
bindsym $mod+t nop i3ipc_tabbed_toggle

# Toggle monocle mode.
bindsym $mod+m nop i3ipc_monocle_toggle

# Toggle secondary to the side of or below of main.
bindsym $mod+backslash nop i3ipc_reflect

# Toggle secondary to the right or left hand side of main.
bindsym $mod+shift+backslash nop i3ipc_mirror

# Toggle workspace.
bindsym $mod+Tab workspace back_and_forth

# Toggle layout current container.
bindsym $mod+semicolon layout toggle tabbed split

#+end_src
